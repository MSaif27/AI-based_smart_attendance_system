{% extends 'base.html' %}
{% block page_title %}{{ student.name }}{% endblock %}
{% block content %}
<div class="row g-4">
<div class="col-md-4">
<div class="glass-card"><div class="card-body-pad" style="text-align:center;">
{% if student.photo %}<img src="{{ student.photo.url }}" style="width:120px;height:120px;border-radius:20px;object-fit:cover;margin-bottom:16px;">
{% else %}<div style="width:120px;height:120px;border-radius:20px;background:linear-gradient(135deg,#8B0000,#f59e0b);display:inline-flex;align-items:center;justify-content:center;font-size:48px;font-weight:800;color:white;margin-bottom:16px;">{{ student.name|first }}</div>{% endif %}
<h4 style="color:white;margin:0;">{{ student.name }}</h4>
<code style="color:var(--gold);font-size:14px;">{{ student.roll_number }}</code>
<div style="margin:12px 0;">
{% if student.face_enrolled %}<span style="background:rgba(16,185,129,0.15);color:#10b981;border:1px solid rgba(16,185,129,0.3);border-radius:20px;padding:4px 14px;font-size:12px;"><i class="fas fa-face-smile-wink me-1"></i>Face Enrolled</span>
{% else %}<span style="background:rgba(239,68,68,0.15);color:#ef4444;border:1px solid rgba(239,68,68,0.3);border-radius:20px;padding:4px 14px;font-size:12px;"><i class="fas fa-times-circle me-1"></i>No Face</span>{% endif %}
</div>
<hr style="border-color:var(--border);">
<div style="text-align:left;">
<p style="font-size:13px;color:var(--text-muted);margin-bottom:6px;"><i class="fas fa-envelope me-2 text-warning"></i>{{ student.email }}</p>
{% if student.parent_email %}<p style="font-size:13px;color:var(--text-muted);margin-bottom:6px;"><i class="fas fa-envelope me-2" style="color:#818cf8;"></i>{{ student.parent_email }} (Parent)</p>{% endif %}
{% if student.phone %}<p style="font-size:13px;color:var(--text-muted);margin-bottom:0;"><i class="fas fa-phone me-2 text-success"></i>{{ student.phone }}</p>{% endif %}
</div>
</div>
<div class="card-body-pad" style="border-top:1px solid var(--border);text-align:center;">
<div style="font-family:'Syne',sans-serif;font-size:52px;font-weight:800;color:{% if percentage >= 75 %}#10b981{% else %}#ef4444{% endif %};">{{ percentage }}%</div>
<div class="prog-bar"><div class="fill" style="width:{{ percentage }}%;background:{% if percentage >= 75 %}var(--success){% else %}var(--danger){% endif %};"></div></div>
{% if percentage < 75 %}<div class="smart-alert danger mt-3" style="font-size:12px;"><i class="fas fa-exclamation-triangle me-1"></i>Below 75% â€” At Risk!</div>
{% else %}<div class="smart-alert success mt-3" style="font-size:12px;"><i class="fas fa-check me-1"></i>Good Standing</div>{% endif %}
<div class="row mt-3 g-2">
<div class="col-4"><div style="color:#10b981;font-size:20px;font-weight:700;">{{ present }}</div><div style="color:var(--text-muted);font-size:11px;">Present</div></div>
<div class="col-4"><div style="color:#ef4444;font-size:20px;font-weight:700;">{{ absent }}</div><div style="color:var(--text-muted);font-size:11px;">Absent</div></div>
<div class="col-4"><div style="color:#f59e0b;font-size:20px;font-weight:700;">{{ total }}</div><div style="color:var(--text-muted);font-size:11px;">Total</div></div>
</div>
</div>
</div>
<div class="col-md-8">
{% if course_stats %}
<div class="glass-card mb-4"><div class="card-head"><i class="fas fa-book"></i> Course-wise Attendance</div>
<table class="smart-table">
<thead><tr><th>Course</th><th>Total</th><th>Present</th><th>Attendance</th></tr></thead>
<tbody>{% for cs in course_stats %}
<tr>
<td><strong style="color:white;">{{ cs.course.code }}</strong><br><span style="font-size:12px;color:var(--text-muted);">{{ cs.course.name }}</span></td>
<td>{{ cs.total }}</td><td>{{ cs.present }}</td>
<td><div style="display:flex;align-items:center;gap:8px;"><div class="prog-bar" style="width:80px;"><div class="fill" style="width:{{ cs.percentage }}%;background:{% if cs.percentage >= 75 %}var(--success){% else %}var(--danger){% endif %};"></div></div>
<span style="font-size:13px;color:{% if cs.percentage >= 75 %}#10b981{% else %}#ef4444{% endif %};">{{ cs.percentage }}%</span></div></td>
</tr>{% endfor %}</tbody>
</table></div>
{% endif %}
<div class="glass-card"><div class="card-head"><i class="fas fa-history"></i> Recent Records</div>
<table class="smart-table">
<thead><tr><th>Date</th><th>Course</th><th>Status</th><th>Method</th></tr></thead>
<tbody>{% for r in records %}
<tr>
<td style="color:var(--text-muted);">{{ r.session.date }}</td>
<td>{{ r.session.course.code }}</td>
<td><span class="badge-{{ r.status }}">{{ r.status|capfirst }}</span></td>
<td>{% if r.method == 'face' %}<span class="badge-face">Face AI</span>{% else %}<span class="badge-manual">Manual</span>{% endif %}</td>
</tr>{% empty %}
<tr><td colspan="4" style="text-align:center;color:var(--text-muted);padding:30px;">No records yet.</td></tr>
{% endfor %}</tbody>
</table></div>
</div></div>
{% endblock %}
